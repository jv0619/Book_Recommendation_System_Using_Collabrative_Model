<!DOCTYPE html>
   <html lang="en">
   <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">

      <!--=============== FAVICON ===============-->
      <link rel="shortcut icon" href="static/assets/img/favicon.png" type="image/x-icon">

      <!--=============== REMIXICONS ===============-->
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/3.5.0/remixicon.css">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.2.0/remixicon.css">

      <!--=============== SWIPER CSS ===============-->
      <link rel="stylesheet" href="static/assets/css/swiper-bundle.min.css">


      <!--=============== CSS ===============-->
      <link rel="stylesheet" href="static/assets/css/styles.css">
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" 
      crossorigin="anonymous">

      <title>Responsive book website - Bedimcode</title>
   </head>
   <body class="body">
      <!--==================== HEADER ====================-->
      <header class="header" id="header">
         <nav class="nav container">
            <a href="#" class="nav__logo" style="text-decoration: none;">
               <i class="ri-book-3-line"></i>
               Book Recommendation System
            </a>

            <div class="nav__menu">
               <ul class="nav__list">
                  <li class="nav__item">
                     <a href="/" class="nav__link">
                        <i class="ri-home-line"></i>
                        <span>Home</span>
                     </a>
                  </li>

                  <li class="nav__item">
                     <a href="/#top" class="nav__link">
                        <i class="ri-award-line"></i> 
                        <span>Top 50</span>
                     </a>
                  </li>

                  <li class="nav__item">
                     <a href="/recommend" class="nav__link">
                        <i class="ri-book-marked-line"></i>
                        <span>Recommendation</span>
                     </a>
                  </li>

                  <li class="nav__item">
                     <a href="/info" class="nav__link">
                        <i class="ri-information-2-line"></i>
                        <span>About Project</span>
                     </a>
                  </li>

                  <li class="nav__item">
                     <a href="/team" class="nav__link">
                        <i class="ri-group-3-line"></i>
                        <span>Team</span>
                     </a>
                  </li>
                  
               </ul>
            </div>

            <div class="nav__actions">
               <i class="ri-moon-line" id="theme-button"></i>
            </div>
         </nav>
         
      </header>

      
      <!--==================== MAIN ====================-->
      <main class="main">
         <!--==================== HOME ====================-->
         <section class="home section" id="home">
            <div class="home__container container grid">
               <div class="home__data">
                  <h1>
                     Recommendation System
                  </h1>
               </div>
               <div class="search__box">
                  <div class="search__bar">
                     <form action="/recommend_books" method="post" class="search_box_input">
                        <input name="user_input" type="text" class="search_input" id="user_input">
                        <button type="submit" class="icon" id="search_icon_for_error_msg"><i class="ri-search-line"></i></button>
                        <!-- <input type="submit" class="button search__btn"> -->
                    </form>
                  </div>
                 <div class="result__box search_box_input_result">
                  
                 </div>
               </div>
            </div>
         </section>

         <!--==================== FEATURED ====================-->
         <section class="recommend section" id="recommend">
            <div class="recommend__container container">
               
               {% if data %}
               <h2 class="recommend__title">Recommendations for {{usrInput}}:</h2>
               <div class="row recommned__swiper">

                  {% for i in data %}
                  <div class="col" style="flex:0 ;">
                    
                        <article class="recommend__card">
                           <img src={{i[2]}} alt="" class="recommend__img">
                           <h2 class="recommend__title">{{ i[0] }}</h2>
                           <div class="recommend__desc">
                              <span class="recommend__author">{{ i[1] }}</span>
                              
                           </div>
                           
                           <div class="recommend__actions">
                              <button><i class="ri-search-line"></i></button>
                              <button><i class="ri-heart-3-line"></i></button>
                              <button><i class="ri-eye-line"></i></button>
                           </div>
                        </article>
               
                  </div>
                  {% endfor %}
               {% elif recommendPage %}
                  <h2 class="home__data">
                     Search for  your favourite books here...
                  </h2>
               {% else %}
                  <center>
                     <h1>
                        No book found related <span style="color: red;">"{{ usrInput }}"</span>
                     </h1>
                  </center>
                     
                  

                  

            {% endif %}
               </div>
            </div>
            
         </section>

         
      <!--==================== FOOTER ====================-->
      <footer class="footer">
         
      </footer>

      <!--========== SEARCH BOX ==========-->
      <script>
         const books_list = {{ booksList | tojson }};

         console.log("output is",books_list);

         const resultsBox = document.querySelector(".search_box_input_result")
         const inputBox = document.getElementById("user_input")

         inputBox.onkeyup = function(){
            let result = []
            let input = inputBox.value
            if(input.length){
               result = books_list.filter((keyword) => {
                  return keyword.toLowerCase().includes(input.toLowerCase())
               })
               console.log("result",result)
            }
            display(result);

            if(!result.length){
               resultsBox.innerHTML = '';
            }
         }

         function display(result){
            const content = result.map((list) => {
               return "<li onclick = selectInput(this)>" + list + "</li>"
            });

            resultsBox.innerHTML = "<ul>" + content.join('') + "</ul>"
         }

         function selectInput(list){
            inputBox.value = list.innerHTML;
            resultsBox.innerHTML = '';
         }

         // let search_icon_for_error_msg = document.getElementById("search_icon_for_error_msg")
         // search_icon_for_error_msg.onclick = () => {
         //    let display_error = document.getElementById("display_error_for_else")
         //    display_error.classList.remove("display_error")
         //    display_error.classList.add("display_not_found")

         // }

      </script>
      

      <!--=============== SCROLLREVEAL ===============-->
      <script src="static/assets/js/scrollreveal.min.js"></script>

      <!--=============== SWIPER JS ===============-->
      <script src="static/assets/js/swiper-bundle.min.js"></script>

      <!--=============== MAIN JS ===============-->
      <script src="static/assets/js/main.js"></script>
   </body>
</html>